/*
 * File:   init.c
 * Author: Fabian Castano
 *
 * Created on June 25, 2022, 13:41 PM
 */

/** ****************************************************************************
 ** ************ INCLUDES ******************************************************
 ** ****************************************************************************/
#include "read.h"

/** ****************************************************************************
 ** ************ DEFINES *******************************************************
 ** ****************************************************************************/

/** ****************************************************************************
 ** ************ EXTERN VARIABLES **********************************************
 ** ****************************************************************************/
extern xQueueHandle colaMensaje;
/** ****************************************************************************
 ** ************ VARIABLES *****************************************************
 ** ****************************************************************************/

/** ****************************************************************************
 ** ************ FUNCTIONS *****************************************************
 ** ****************************************************************************/

void lee1(void *pvParameter)
{
    int i;
    char Rx[8];
    while (1)
    {
        if (xQueueReceive(colaMensaje, &Rx, 10000 / portTICK_PERIOD_MS) == pdTRUE)
        { // 10s --> Tiempo max. que la tarea está bloqueada si la cola está vacía
            for (i = 0; i < strlen(Rx); i++)
            {
                printf("%c", Rx[i]);
            }
        }
        else
        {
            printf("Fallo al leer la cola\n");
        }
    }
    vTaskDelete(NULL);
}

/** ****************************************************************************
 ** ************ END OF THE CODE ***********************************************
 ** ****************************************************************************/